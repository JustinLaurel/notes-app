(this["webpackJsonpnotes-app"]=this["webpackJsonpnotes-app"]||[]).push([[0],{198:function(e,t,n){},199:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(20),o=n.n(c),i=n(38),s=n(16),u=n(10),l=n(83),b=n(15),d=n(84),j=3e3,p="Username must have at least ".concat(6," characters"),f="You must have a first and a last name",O={notLoggedIn:{description:"You need to be logged in to add notes",status:"error",duration:j,isClosable:!0},noteTooShort:function(){return{description:"Note needs to be at least ".concat(4," characters long"),status:"error",duration:j,isClosable:!0}},failedGet:{description:"Failed to get notes, please check your network",status:"error",duration:j,isClosable:!0},failedCreate:{description:"Failed to create note",status:"error",duration:j,isClosable:!0}},h=n(3),v=n(11),g=n(14),m=n(8),x=n.n(m),w=n(27),y=n.n(w),k=function(e){if(F(e))return{username:e.username,password:e.password};throw new Error("Invalid username or password")},S=function(e){return!(!e||"object"!==typeof e)&&("token"in e&&"username"in e&&"name"in e)},F=function(e){return!!(e&&"object"===typeof e&&"username"in e&&"password"in e)},C=function(){var e=Object(v.a)(x.a.mark((function e(t){var n,r,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("logging in"),e.next=4,y.a.post("/api/login",Object(h.a)({},t));case 4:return n=e.sent,r=n.data,e.abrupt("return",r);case 9:throw e.prev=9,e.t0=e.catch(0),new Error(null===(a=e.t0.response)||void 0===a?void 0:a.data.error);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),E={login:C},N=function(){var e=I();return e?{headers:{authorization:e.token}}:null},I=function(){var e=window.localStorage.getItem("tokenData");return e?function(e){if(!e||!S(e))throw new Error("Invalid or missing token");return e}(JSON.parse(e)):null},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,a=window.localStorage;switch(n){case"login/init":return S(r)?Object(h.a)({},r):Object(h.a)({},e);case"login/storeToken":return S(r)?(a.setItem("tokenData",JSON.stringify(r)),Object(h.a)({},r)):(console.error("Missing or invalid token after login, cannot set to localStorage"),Object(h.a)({},e));case"login/logout":return a.removeItem("tokenData"),{};default:return Object(h.a)({},e)}},_="/api/notes",V="POSITION",z="CONTENT",D=function(){var e=Object(v.a)(x.a.mark((function e(t,n){var r,a,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=_,e.t0=n,e.next=e.t0===V?4:e.t0===z?6:8;break;case 4:return r+="/position",e.abrupt("break",10);case 6:return r+="/content",e.abrupt("break",10);case 8:return a=n,e.abrupt("return",a);case 10:return e.next=12,y.a.put(r,t);case 12:return c=e.sent,e.abrupt("return",c);case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),L=function(){var e=Object(v.a)(x.a.mark((function e(){var t,n,r,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=I())){e.next=10;break}return n={headers:{authorization:t.token}},e.next=5,y.a.get(_,n);case 5:return r=e.sent,a=r.data,e.abrupt("return",a);case 10:return e.abrupt("return",null);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=Object(v.a)(x.a.mark((function e(t){var n,r,a,c,o;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=I(),e.prev=1,!n){e.next=11;break}return r={note:t,token:n.token},e.next=6,y.a.post(_,r);case 6:return a=e.sent,c=a.data,e.abrupt("return",c);case 11:throw new Error("Failed to add note, user currently not logged in");case 12:e.next=17;break;case 14:throw e.prev=14,e.t0=e.catch(1),new Error(null===(o=e.t0.response)||void 0===o?void 0:o.data);case 17:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(v.a)(x.a.mark((function e(t,n){var r,a,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=I())){e.next=9;break}return a=r.token,e.next=5,y.a.delete("".concat(_,"/").concat(t),{data:{token:a,toUpdate:n}});case 5:return c=e.sent,e.abrupt("return",c);case 9:throw new Error("Failed to delete note, user currently not logged in");case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),R={getAll:L,addNew:P,remove:T,update:D},J=function(e){return"string"===typeof e||e instanceof String},U=function(e){return!(!e&&"string"!==typeof e)&&!!J(e)},B=U,G=function(e){return!!e&&(!!B(e._id)&&!!function(e){return!!e&&!!B(e.content)&&!(!B(e.created)||!W(e.created))&&!!B(e.position)}(e))},M=function(e){return!!e&&(!!B(e.match)&&G(e.note))},H=function(e){return Array.isArray(e)&&e.every(G)},W=function(e){return Boolean(Date.parse(e))},q=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],a={_id:r._id,position:r.position};t.push(a)}return t},Y=n(40),K=function(e){return JSON.stringify(Number(e)+1)},Z=function(e,t,n){return e>=t&&e<=n},Q=function(e,t){return e.filter((function(e){return e._id!==t}))},X=function(e,t,n){var r,a=[];if(n>t)for(var c=0;c<e.length;c++){var o=e[c];Z(Number(o.position),t+1,n)&&(o.position=(r=o.position,JSON.stringify(Number(r)-1)),a.push(o))}else if(n<t)for(var i=0;i<e.length;i++){var s=e[i];Z(Number(s.position),n,t-1)&&(s.position=K(s.position),a.push(s))}return e[n].position=JSON.stringify(n),a.push(e[n]),{updated:e,changedNotes:a}},$=function(e,t,n){return Object(g.a)(Object(Y.b)(e,t,n))},ee=function(){var e=Object(v.a)(x.a.mark((function e(t){var n,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=q(t),e.next=3,R.update(n,V);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(e,t){for(var n=[],r=0;r<e.length;r++){var a=e[r];Number(a.position)>Number(t)&&(a.position=JSON.stringify(Number(a.position)-1),n.push(a))}return{updated:e,changedNotes:n}},ne=function(){return function(){var e=Object(v.a)(x.a.mark((function e(t){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.getAll();case 2:n=e.sent,t({type:"notes/initialize",payload:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case"notes/initialize":return H(r)?Object(g.a)(r):Object(g.a)(e);case"notes/remove":if(B(r)){var a=r,c=Q(e,a);return c}return console.error("Failed deletion of note state"),Object(g.a)(e);case"notes/create":return G(r)?[].concat(Object(g.a)(e),[r]):(console.error("Failed adding created note to state"),Object(g.a)(e));case"notes/updateOne":if(M(r)){var o=Object(g.a)(e),i=o.findIndex((function(e){return e._id===r.match}));return o[i]=r.note,o}return console.error("Payload in notes/updateOne reducer is not an UpdatePayload"),Object(g.a)(e);case"notes/updateArray":return H(r)?Object(g.a)(r):(console.error("Failed to update notes in notes reducer"),Object(g.a)(e));case"notes/clear":return[];default:return Object(g.a)(e)}},ae=n(76),ce=n(5),oe=function(){return Object(ce.jsxs)(ae.a,Object(h.a)(Object(h.a)({},{separator:"-",fontWeight:"medium",fontSize:"25px",fontFamily:"flexa"}),{},{children:[Object(ce.jsx)(ae.b,{children:Object(ce.jsx)(ae.c,{as:i.b,to:"/",d:"inline",children:"Home"})}),Object(ce.jsx)(ae.b,{children:Object(ce.jsx)(ae.c,{as:i.b,to:"/notes",d:"inline",children:"Notes"})}),Object(ce.jsx)(ae.b,{children:Object(ce.jsx)(ae.c,{as:i.b,to:"/pad",d:"inline",children:"Pad"})}),Object(ce.jsx)(ae.b,{children:Object(ce.jsx)(ae.c,{as:i.b,to:"/user",d:"inline",children:"User"})}),Object(ce.jsx)(ae.b,{children:Object(ce.jsx)(ae.c,{as:i.b,to:"/about",d:"inline",children:"About"})})]}))},ie=function(){return Object(ce.jsxs)(d.a,Object(h.a)(Object(h.a)({},{fontFamily:'"Lato",  sans serif',fontSize:"16px"}),{},{children:[Object(ce.jsx)("h3",{children:Object(ce.jsx)("i",{children:"Notes app, by Chiew Weng Keat"})}),Object(ce.jsxs)("p",{children:["\u2003 total notes stored: ",Object(ce.jsx)("br",{}),"\u2003 total users:"]})]}))},se=n(19),ue=n(65),le=n(78),be=function(e){for(var t=e.rows,n={height:"1.625rem",width:"31.25rem",alignSelf:"center"},r=[],c=0;c<t;c++)r.push(Object(ce.jsxs)(a.a.Fragment,{children:[Object(ce.jsx)(le.a,{style:n}),Object(ce.jsx)(le.b,{visibility:"hidden"}),Object(ce.jsx)(le.b,{visibility:"hidden"})]},c));return Object(ce.jsx)(ce.Fragment,{children:r})},de=n(13),je=n(44),pe=n(80),fe=n(79),Oe=n(4),he=n(90),ve="noteActionViews/editing",ge=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isEditing:!1,noteId:null},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case"".concat(ve,"/set"):return J(r)?Object(h.a)(Object(h.a)({},e),{},{isEditing:!0,noteId:r}):(console.log("Invalid noteId: ".concat(JSON.stringify(r))),Object(h.a)({},e));case"".concat(ve,"/reset"):return Object(h.a)(Object(h.a)({},e),{},{isEditing:!1,noteId:null});default:return Object(h.a)({},e)}},me=Object(Oe.d)(he.a),xe=function(e){var t=e.handleEdit,n={bgColor:e.isEditing?"gray.400":"transparent",borderRadius:"full",size:"sm",_hover:{bgColor:"gray.400"},title:"edit"};return Object(ce.jsx)(fe.b,Object(h.a)(Object(h.a)({},n),{},{"aria-label":"edit note",icon:Object(ce.jsx)(me,{}),onClick:t}))},we=function(e){var t=e.note,n=e.isEditing,r=Object(u.b)();return Object(ce.jsx)(xe,{isEditing:n,handleEdit:function(e){var n;e.preventDefault(),r((n=t._id,function(e){e({type:"".concat(ve,"/set"),payload:n})}))}})},ye=n(97),ke=function(e){var t=e.handleDelete,n=e.toggleHighlight;return Object(ce.jsx)(fe.b,Object(h.a)(Object(h.a)({},{color:"black",borderRadius:"full",bgColor:"transparent",size:"sm",_hover:{color:"white",bgColor:"red.900"},title:"delete"}),{},{"aria-label":"delete",icon:Object(ce.jsx)(ye.a,{}),onClick:t,onMouseOver:n,onMouseOut:n,children:"delete"}))},Se=function(e){var t=e.note,n=Object(u.b)();return Object(ce.jsx)(ke,{handleDelete:function(e){e.preventDefault(),n(function(e){return function(){var t=Object(v.a)(x.a.mark((function t(n,r){var a,c,o,i,s,u;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=Object(g.a)(r().notes),c=e.position,o=te(a,c),i=o.updated,s=o.changedNotes,u=q(s),n({type:"notes/updateArray",payload:i}),n({type:"notes/remove",payload:e._id}),t.next=9,R.remove(e._id,u);case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.error("Error deleting note: ".concat(t.t0.message));case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e,n){return t.apply(this,arguments)}}()}(t))},toggleHighlight:function(){var e=document.getElementById(t._id);if(e)switch(e.style.color){case"red":e.style.color="";break;case"":e.style.color="red"}}})},Fe=n(91),Ce=function(e){var t=e.note,n=Object(u.b)(),a=Object(r.useState)(t.content),c=Object(de.a)(a,2),o=c[0],i=c[1],s=Object(r.useRef)(null);Object(r.useEffect)((function(){i(t.content)}),[t.content]);var l=function(e){if(e.preventDefault(),n((function(e){e({type:"".concat(ve,"/reset")})})),o!==t.content){var r=Object(h.a)(Object(h.a)({},t),{},{content:o});n(function(e){return function(){var t=Object(v.a)(x.a.mark((function t(n){var r;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:"notes/updateOne",payload:{match:e._id,note:e}}),t.prev=1,t.next=4,R.update(e,z);case 4:return r=t.sent,t.abrupt("return",r);case 8:t.prev=8,t.t0=t.catch(1),console.error("Error deleting note: ".concat(t.t0.message));case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}()}(r))}};return Object(ce.jsxs)(je.a,{as:"form",onSubmit:l,children:[Object(ce.jsx)(pe.a,{ref:s,as:"textarea",id:t._id,style:{height:"32px",padding:"0px",verticalAlign:"top",overflow:"hidden"},autoFocus:!0,autoComplete:"off",value:o,rows:1,spellCheck:!1,onChange:function(e){return i(e.currentTarget.value)},onBlur:l}),Object(ce.jsx)(fe.a,{style:{display:"none"}})]})},Ee=function(e){var t=e.note,n=Object(Y.c)({id:t.position}),c=n.setNodeRef,o=n.attributes,i=n.listeners,s=n.transition,l=n.transform,b={transition:s,transform:l?"translate3d(".concat(null===l||void 0===l?void 0:l.x,"px, ").concat(null===l||void 0===l?void 0:l.y,"px, 0)"):void 0},j=Object(u.c)((function(e){return e.noteActionViews})),p=j.isEditing&&j.noteId===t._id,f=Object(ce.jsx)(d.a,Object(h.a)(Object(h.a)(Object(h.a)({id:t._id,ref:c},o),i),{},{style:b,children:t.content})),O=p?Object(ce.jsx)(Ce,{note:t}):f;return Object(r.useEffect)((function(){p&&Object(Fe.a)(document.querySelector("textarea"))}),[p]),Object(ce.jsxs)(a.a.Fragment,{children:[O,Object(ce.jsx)(d.b,{children:Object(ce.jsx)(we,{note:t,isEditing:p})}),Object(ce.jsx)(d.b,{children:Object(ce.jsx)(Se,{note:t})})]},t._id)},Ne=function(){var e=Object(u.c)((function(e){return e.notes})),t=Object(u.b)(),n=I()&&0===e.length?Object(ce.jsx)(be,{rows:5}):e.map((function(e){return Object(ce.jsx)(Ee,{note:e},e.position)}));return Object(ce.jsx)(d.c,Object(h.a)(Object(h.a)(Object(h.a)({},{mt:"1",templateColumns:"minmax(auto, 37.5rem) 1.875rem 1.875rem",autoRows:"min-max(2rem, max-content)",rowGap:"5px"}),{fontFamily:'"Lato",  sans serif',fontSize:"1rem"}),{},{children:Object(ce.jsx)(se.a,{onDragEnd:function(n){var r=n.active,a=n.over;if(r&&a){var c=e.findIndex((function(e){return e.position===r.id})),o=e.findIndex((function(e){return e.position===a.id}));c!==o&&t(function(e,t){return function(){var n=Object(v.a)(x.a.mark((function n(r,a){var c,o,i,s,u;return x.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=a().notes,o=$(c,e,t),i=X(o,e,t),s=i.updated,u=i.changedNotes,r({type:"notes/updateArray",payload:s}),n.next=6,ee(u);case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()}(c,o))}},modifiers:[ue.b,ue.a],collisionDetection:se.c,children:Object(ce.jsx)(Y.a,{items:e.map((function(e){return e.position})),strategy:Y.d,children:n})})}))},Ie=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=Object(r.useState)(t),a=Object(de.a)(n,2),c=a[0],o=a[1],i=function(e){return o(e.currentTarget.value)},s=function(){return o("")};return{type:e,value:c,onChange:i,clearField:s}},Ae=n(81),_e=Object(r.forwardRef)((function(e,t){var n=e.onSubmit,r=e.noteInput,a={input:{placeholder:"new note...",size:"sm",w:"min(95%, 27.5rem)",variant:"filled",borderRadius:"2xl",m:1.5,ml:-.5,colorScheme:"facebook",autoComplete:"off"},button:{size:"xs",bgColor:"black",color:"white",colorScheme:"twitter",_hover:{bgColor:"gray.600"},title:"save new note",type:"submit"}};return Object(ce.jsxs)(je.a,{as:"form",onSubmit:n,children:[Object(ce.jsx)(Ae.a,Object(h.a)(Object(h.a)({ref:t},a.input),r)),Object(ce.jsx)(fe.a,Object(h.a)(Object(h.a)({},a.button),{},{children:"save"}))]})})),Ve=function(){var e=Ie("text"),t=Object(u.b)(),n=Object(l.a)(),a=function(){return e.value.length<4?(n(O.noteTooShort()),!1):!!Boolean(I())||(n(O.notLoggedIn),!1)},c=Object(r.useRef)(null);return document.addEventListener("keyup",(function(e){var t;"Slash"!==e.code||!c.current||null!==(t=document.activeElement)&&void 0!==t&&t.id||c.current.focus()})),Object(ce.jsx)(_e,{ref:c,onSubmit:function(r){var c;if(r.preventDefault(),a())try{t((c=e.value,function(){var e=Object(v.a)(x.a.mark((function e(t,n){var r,a,o,i;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n().notes.at(-1),a={content:c,created:(new Date).toString(),position:r?JSON.stringify(Number(r.position)+1):"0"},o=JSON.stringify(Math.round(1e8*Math.random())),e.prev=3,t({type:"notes/create",payload:Object(h.a)(Object(h.a)({},a),{},{_id:o})}),e.next=7,R.addNew(a);case 7:i=e.sent,t({type:"notes/remove",payload:o}),t({type:"notes/create",payload:i}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),console.error("Error adding note: ".concat(e.t0.message));case 15:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t,n){return e.apply(this,arguments)}}())),e.clearField()}catch(r){console.error(r.message),n(O.failedCreate)}},noteInput:e})},ze=n(96),De=(n(154),n(156),n(158),n(160),n(162),n(164),n(166),n(168),n(170),n(172),n(174),n(176),n(178),n(180),n(182),n(184),n(186),n(188),n(190),n(192),n(194),n(195),n(196),function(e){var t=e;return"_id"in t&&"string"===typeof t._id&&"content"in t&&"string"===typeof t.content&&"user"in t&&"string"===typeof t.user}),Le=function(e){if(!De(e))throw new Error("Value from backend is not a valid Pad object");return e},Pe="/api/pad",Te=function(){var e=Object(v.a)(x.a.mark((function e(){var t,n,r,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(t=N())){e.next=10;break}return e.next=5,y.a.get(Pe,t);case 5:return n=e.sent,r=n.data,e.abrupt("return",Le(r));case 10:return e.abrupt("return",null);case 11:e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(0),new Error(null===(a=e.t0.response)||void 0===a?void 0:a.data);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}(),Re=function(){var e=Object(v.a)(x.a.mark((function e(t){var n,r,a,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(n=N())){e.next=10;break}return e.next=5,y.a.put(Pe,{content:t},n);case 5:return r=e.sent,a=r.data,e.abrupt("return",a);case 10:return e.abrupt("return",null);case 11:e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(0),new Error(null===(c=e.t0.response)||void 0===c?void 0:c.data);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),Je={get:Te,update:Re},Ue=function(){var e=Object(v.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Je.get();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Be={error:{description:"Failed to retrieve Pad contents",status:"error",duration:j,isClosable:!0}},Ge=function(){var e=Object(u.c)((function(e){return e.login})),t=Object(l.a)();Object(r.useEffect)((function(){var n;0!==Object.keys(e).length?new Promise((function(e){e(Ue())})).then((function(e){var t;De(e)&&(null===(t=a.current)||void 0===t||t.setContent(e.content))})).catch((function(e){console.error("Failed to retrieve pad content: ".concat(e.message)),t(Be.error)})):null===(n=a.current)||void 0===n||n.setContent("")}),[e]);var n=function(){var e=Object(v.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.current){e.next=4;break}return t=a.current.getContent(),e.next=4,Je.update(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),a=Object(r.useRef)(null),c=Object(ce.jsx)(ze.a,{onInit:function(e,t){a.current=t},init:{skin:!1,menubar:!1,plugins:["advlist autolink lists link image","charmap print preview anchor help","searchreplace visualblocks code importcss","insertdatetime media table save"],statusbar:!1,toolbar:"undo redo | bold italic |                    underline strikethrough | superscript subscript charmap code |                    alignleft aligncenter alignright alignjustify |                    bullist numlist outdent indent | blockquote |                    link image media table | forecolor backcolor |                    removeformat fontsizeselect | fontselect | save | help",toolbar_mode:"wrap",contextmenu:!1,width:"min(99%, 112.5rem)",height:"min(56rem, 64rem)",branding:!1,image_caption:!1,forced_root_block:"p",save_onsavecallback:n},onChange:function(){var e;console.log("Content was updated: ".concat(null===(e=a.current)||void 0===e?void 0:e.getContent()))}});return Object(ce.jsx)("div",Object(h.a)(Object(h.a)({},{display:"flex",flexDirection:"column",mt:2}),{},{children:I()?c:null}))},Me="userFormViews/loginForm",He="userFormViews/signupForm",We=function(){return function(e){e({type:"".concat(Me,"/toggle")})}},qe=function(){return function(e){e({type:"".concat(Me,"/spinner/hide")})}},Ye=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loginForm:!1,loginSpinner:!1,signupForm:!1,signupSpinner:!1},t=arguments.length>1?arguments[1]:void 0,n=t.type;switch(n){case"".concat(Me,"/toggle"):return Object(h.a)(Object(h.a)({},e),{},{signupForm:!1,loginForm:!e.loginForm});case"".concat(Me,"/show"):return Object(h.a)(Object(h.a)({},e),{},{signupForm:!1,loginForm:!0});case"".concat(Me,"/hide"):return Object(h.a)(Object(h.a)({},e),{},{loginForm:!1});case"".concat(Me,"/spinner/show"):return Object(h.a)(Object(h.a)({},e),{},{loginSpinner:!0});case"".concat(Me,"/spinner/hide"):return Object(h.a)(Object(h.a)({},e),{},{loginSpinner:!1});case"".concat(He,"/toggle"):return Object(h.a)(Object(h.a)({},e),{},{loginForm:!1,signupForm:!e.signupForm});case"".concat(He,"/show"):return Object(h.a)(Object(h.a)({},e),{},{loginForm:!1,signupForm:!0});case"".concat(He,"/hide"):return Object(h.a)(Object(h.a)({},e),{},{signupForm:!1});case"".concat(He,"/spinner/show"):return Object(h.a)(Object(h.a)({},e),{},{signupSpinner:!0});case"".concat(He,"/spinner/hide"):return Object(h.a)(Object(h.a)({},e),{},{signupSpinner:!1});default:return Object(h.a)({},e)}},Ke={failed:{description:"Login failed. Please try again",status:"error",duration:j,isClosable:!0},success:function(e){return{description:"logged in as ".concat(e),status:"success",duration:j,isClosable:!0}},error:function(e){return{description:"".concat(e),status:"error",duration:j,isClosable:!0}}},Ze={success:function(e){return{description:"".concat(e," logged out"),status:"success",duration:j,isClosable:!0}},failed:function(e){return{description:"Error logging out: ".concat(e),status:"error",duration:j,isClosable:!0}}},Qe=n(51),Xe=n(43),$e=function(e){var t=e.handleLogin,n=e.username,r=e.password,a=e.showSpinner,c={input:{size:"sm",w:200,variant:"filled",borderRadius:"xl"},button:{size:"xs",bgColor:"blue.300",display:"inline",title:"login",type:"submit"}},o=Object(Oe.d)(Xe.c),i=Object(Oe.d)(Xe.b);return Object(ce.jsx)(je.a,{as:"form",onSubmit:t,children:Object(ce.jsxs)(d.f,{spacing:.5,children:[Object(ce.jsxs)(Ae.b,Object(h.a)(Object(h.a)({},c.input),{},{children:[Object(ce.jsx)(Ae.c,{pointerEvents:"none",children:Object(ce.jsx)(o,{})}),Object(ce.jsx)(Ae.a,Object(h.a)(Object(h.a)(Object(h.a)({},n),c.input),{},{placeholder:"username"}))," ",Object(ce.jsx)("br",{})]})),Object(ce.jsxs)(Ae.b,Object(h.a)(Object(h.a)({},c.input),{},{children:[Object(ce.jsx)(Ae.c,{pointerEvents:"none",children:Object(ce.jsx)(i,{})}),Object(ce.jsx)(Ae.a,Object(h.a)(Object(h.a)(Object(h.a)({},r),c.input),{},{placeholder:"password"}))]})),Object(ce.jsxs)(d.a,{children:[Object(ce.jsx)(fe.a,Object(h.a)(Object(h.a)({},c.button),{},{children:"login"})),Object(ce.jsx)(et,{isVisible:a})]})]})})},et=function(e){return e.isVisible?Object(ce.jsx)(Qe.a,Object(h.a)({},{size:"sm",verticalAlign:"middle",margin:"7px"})):null},tt=function(){var e=Object(u.b)(),t=Object(l.a)(),n=Object(u.c)((function(e){return e.userFormViews.loginForm})),r=Object(u.c)((function(e){return e.userFormViews.loginSpinner})),a=Ie("text"),c=Ie("password"),o=function(t){t.clear(),e(qe())};return Object(ce.jsx)(ce.Fragment,{children:n?Object(ce.jsx)($e,{handleLogin:function(n){console.log("handleLogin called"),n.preventDefault();var r=function(){var e=null;return{set:function(t,n){if(t instanceof Function){var r=setTimeout(t,n);e=r}},clear:function(){e&&(clearTimeout(e),e=null)}}}();new Promise((function(n){e((function(e){e({type:"".concat(Me,"/spinner/show")})})),function(n){n.set((function(){t(Ke.failed),e(qe())}),5e3)}(r);var o,i=e((o={username:a.value,password:c.value},function(){var e=Object(v.a)(x.a.mark((function e(t){var n,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=k(o),e.next=3,E.login(n);case 3:if(r=e.sent,S(r)){e.next=6;break}throw new Error("Invalid username or password");case 6:return t({type:"login/storeToken",payload:r}),t({type:"login/init",payload:r}),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));n(i)})).then((function(n){S(n)&&(o(r),e(ne()),t(Ke.success(n.name)),a.clearField(),c.clearField(),e(We()))})).catch((function(e){o(r),t(Ke.error(e.message))}))},username:a,password:c,showSpinner:r}):null})},nt=function(e){var t=e.handleSubmit;return Object(ce.jsx)(fe.a,Object(h.a)(Object(h.a)({onClick:t},{size:"xs",fontSize:"12px",borderRadius:"6px",color:"black",bg:"red.500",_hover:{bg:"red.800",color:"white"}}),{},{children:"logout"}))},rt=function(){var e=Object(u.b)(),t=Object(l.a)(),n=Object(u.c)((function(e){return e.login}));return 0===Object.keys(n).length?null:Object(ce.jsx)(nt,{handleSubmit:function(n){n.preventDefault();try{var r,a=null===(r=I())||void 0===r?void 0:r.name;e((function(e){var t;(null===(t=I())||void 0===t?void 0:t.name)&&e({type:"login/logout",payload:{}})})),e((function(e){e({type:"".concat(Me,"/show")})})),function(e){e&&t(Ze.success(e))}(a),e((function(e){e({type:"notes/clear"})}))}catch(n){t(Ze.failed(n.message))}}})},at=function(e){var t=e.toggleVisibility;return Object(ce.jsx)(fe.a,Object(h.a)(Object(h.a)({},{size:"xs",bgColor:"blue.300"}),{},{onClick:function(e){e.preventDefault(),t()},children:"login"}))},ct=function(e){var t=e.toggleVisibility;return Object(ce.jsx)(fe.a,Object(h.a)(Object(h.a)({},{size:"xs",bgColor:"green.300"}),{},{onClick:function(e){e.preventDefault(),t()},children:"sign up"}))},ot=function(e){var t=e.name;return Object(ce.jsxs)("p",{style:{display:"inline",marginLeft:"5px",fontFamily:'"Lato", sans-serif'},children:["logged in as ",t]})},it=function(){var e=Object(u.c)((function(e){return e.login})),t=Object(u.b)(),n={display:"inline",fontSize:"0.9em",fontStyle:"italic",wordSpacing:"-0.1em"};return S(e)?Object(ce.jsxs)("div",{style:n,children:[Object(ce.jsx)(rt,{}),Object(ce.jsx)(ot,{name:e.name})]}):Object(ce.jsxs)("div",{style:n,children:[Object(ce.jsx)(at,{toggleVisibility:function(){t(We())}}),Object(ce.jsx)(ct,{toggleVisibility:function(){t((function(e){e({type:"".concat(He,"/toggle")})}))}})]})},st=n(93),ut=n(94),lt=Object(Oe.d)(st.a),bt=Object(Oe.d)(ut.a),dt={padding:"0",marginLeft:"0",fontSize:"14",fontFamily:'"Lato",  sans serif'},jt={fontWeight:"bold"},pt={listStyleType:"none"},ft=Object(ce.jsx)(d.d,{as:lt,color:"green.500"}),Ot=Object(ce.jsx)(d.d,{as:bt,color:"red.500"}),ht=function(e){return/[a-zA-Z]/.test(e)},vt=function(e){return/\d/.test(e)},gt=function(e,t){return e.length>=t},mt=function(e){if(!e)throw console.error("argument to parseSignupData is falsey"),new Error("Unexpected error. Please refresh the page");var t,n=e;if("firstName"in n&&xt(n.firstName,1)){if("lastName"in n&&xt(n.lastName,1)){if("username"in n&&xt(n.username,6)){if("password"in n&&(t=n.password,ht(t)&&vt(t)&&gt(t,8))){if("verify"in n&&n.verify===n.password)return{username:n.username,name:n.firstName+" "+n.lastName,password:n.password};throw new Error("Passwords do not match")}throw new Error("Invalid password format")}throw new Error(p)}throw new Error(f)}throw new Error(f)},xt=function(e,t){return J(e)&&gt(e,t)},wt=function(e){var t=e.letterIsValid,n=e.numberIsValid,r=e.characterIsValid;return Object(ce.jsxs)(d.a,Object(h.a)(Object(h.a)({},dt),{},{children:[Object(ce.jsx)(d.a,Object(h.a)(Object(h.a)({as:"span"},jt),{},{children:"Password"})),Object(ce.jsxs)(d.g,Object(h.a)(Object(h.a)({},pt),{},{children:[Object(ce.jsxs)(d.e,{children:[t?ft:Ot,"1 letter minimum"]}),Object(ce.jsxs)(d.e,{children:[n?ft:Ot,"1 number minimum"]}),Object(ce.jsxs)(d.e,{children:[r?ft:Ot,"8 characters minimum"]})]}))]}))},yt=function(e){var t=e.password,n=Object(r.useState)(!1),a=Object(de.a)(n,2),c=a[0],o=a[1],i=Object(r.useState)(!1),s=Object(de.a)(i,2),u=s[0],l=s[1],b=Object(r.useState)(!1),d=Object(de.a)(b,2),j=d[0],p=d[1];return Object(r.useEffect)((function(){o(gt(t,8)),l(vt(t)),p(ht(t))}),[t]),Object(ce.jsx)(wt,{letterIsValid:j,numberIsValid:u,characterIsValid:c})},kt=function(e){var t=e.characterIsValid,n=e.usernameAvailable;return Object(ce.jsxs)(d.a,Object(h.a)(Object(h.a)({},dt),{},{children:[Object(ce.jsx)(d.a,Object(h.a)(Object(h.a)({as:"span"},jt),{},{children:"Username"})),Object(ce.jsxs)(d.g,Object(h.a)(Object(h.a)({},pt),{},{children:[Object(ce.jsxs)(d.e,{children:[t?ft:Ot,"6 characters minimum"]}),Object(ce.jsxs)(d.e,{children:[n?ft:Ot,"checked"]})]}))]}))},St=function(e){var t=e.username,n=Object(r.useState)(!1),a=Object(de.a)(n,2),c=a[0],o=a[1],i=Object(r.useState)(!1),s=Object(de.a)(i,2),l=s[0],b=s[1],d=Object(u.c)((function(e){return e.signup}));return Object(r.useEffect)((function(){o(gt(t,6)),b(d.includes(t.toLowerCase()))}),[t,d]),Object(ce.jsx)(kt,{characterIsValid:c,usernameAvailable:l})},Ft=function(e){var t=e.password,n=e.username,r=e.gridArea;return Object(ce.jsxs)(d.a,{gridArea:r,children:[Object(ce.jsx)(St,{username:n}),Object(ce.jsx)(yt,{password:t})]})},Ct="/api/users",Et=function(){var e=Object(v.a)(x.a.mark((function e(t){var n,r,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.a.post(Ct,t);case 3:if(n=e.sent,r=n.data,S(r)){e.next=7;break}throw new Error("Failed to create account. Please try again");case 7:return e.abrupt("return",r);case 10:throw e.prev=10,e.t0=e.catch(0),new Error(null===(a=e.t0.response)||void 0===a?void 0:a.data);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),Nt=function(){var e=Object(v.a)(x.a.mark((function e(t){var n,r,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.a.get("".concat(Ct,"/").concat(t));case 3:return n=e.sent,r=n.data,e.abrupt("return",r);case 8:throw e.prev=8,e.t0=e.catch(0),new Error("Username available checking error with backend: ".concat(null===(a=e.t0.response)||void 0===a?void 0:a.data.error));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),It={signup:Et,checkUsernameAvailable:Nt},At=function(){var e=Object(v.a)(x.a.mark((function e(t){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,It.checkUsernameAvailable(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return"signup/username/save"===n&&U(r)?[].concat(Object(g.a)(e),[r]):Object(g.a)(e)},Vt={failed:function(e){return{description:e,status:"error",duration:j,isClosable:!0}},success:{description:"Account successfully created",status:"success",duration:j,isClosable:!0},available:function(e){return{description:"username ".concat(e," is available"),status:"success",duration:j,isClosable:!0}}},zt=function(e){var t=e.username,n=Object(u.b)(),r=Object(l.a)();return Object(ce.jsx)(fe.a,Object(h.a)(Object(h.a)({},{fontSize:"12px",height:"24px",alignSelf:"center",color:"white",width:"min-content",marginLeft:"6px",backgroundColor:"red.700",_hover:{bg:"red.500",cursor:"pointer"},_focus:{bg:"blue"}}),{},{as:"div",onClick:function(e){e.preventDefault();var a=t.toLowerCase();new Promise((function(e){if(t.length<6)throw new Error(p);var r=n(function(e){return function(){var t=Object(v.a)(x.a.mark((function t(n,r){var a,c;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.toLowerCase(),!(c=r().signup)||!c.includes(a)){t.next=6;break}return t.abrupt("return",!0);case 6:return t.next=8,At(a);case 8:if(!t.sent){t.next=14;break}return n({type:"signup/username/save",payload:e}),t.abrupt("return",!0);case 14:return t.abrupt("return",!1);case 15:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}(a));e(r)})).then((function(e){"boolean"===typeof e&&r(e?Vt.available(t):Vt.failed("username ".concat(t," is already taken")))})).catch((function(e){r(Vt.failed(e.message)),console.log("failed checking availability: ".concat(e.message))}))},children:"check"}))},Dt=Object(Oe.d)(Xe.c),Lt=Object(Oe.d)(Xe.b),Pt=Object(Oe.d)(Xe.a),Tt=function(e){var t=e.firstName,n=e.lastName,r=e.username,a=e.password,c=e.verify,o=e.spinnerVisible,i=e.handleSignup,s={size:"sm",w:"100%",variant:"filled"},u={size:"xs",textColor:"white",bgColor:"blue.700",width:"min-content",_hover:{bg:"blue.400"},justifySelf:"right",marginRight:"10px",display:"inline",type:"submit"},l=o?Object(ce.jsx)(fe.a,Object(h.a)(Object(h.a)({},u),{},{gridArea:"submit",isLoading:!0,onSubmit:i,children:"sign up"})):Object(ce.jsx)(fe.a,Object(h.a)(Object(h.a)({},u),{},{gridArea:"submit",onSubmit:i,children:"sign up"}));return Object(ce.jsx)(je.a,{as:"form",onSubmit:i,children:Object(ce.jsxs)(d.c,Object(h.a)(Object(h.a)({},{templateColumns:"1fr 1fr",templateAreas:"'firstName lastName'\n            'username username'\n            'password verify'\n            'tooltips submit'",width:400,columnGap:"5px",rowGap:"7px"}),{},{children:[Object(ce.jsxs)(Ae.b,Object(h.a)(Object(h.a)({},s),{},{gridArea:"firstName",children:[Object(ce.jsx)(Ae.c,{pointerEvents:"none",children:Object(ce.jsx)(Pt,{})}),Object(ce.jsx)(Ae.a,Object(h.a)(Object(h.a)(Object(h.a)({},t),s),{},{maxlength:20,placeholder:"first name"}))]})),Object(ce.jsx)(Ae.b,Object(h.a)(Object(h.a)({},s),{},{gridArea:"lastName",children:Object(ce.jsx)(Ae.a,Object(h.a)(Object(h.a)(Object(h.a)({},n),s),{},{maxlength:20,placeholder:"last name"}))})),Object(ce.jsxs)(Ae.b,Object(h.a)(Object(h.a)({},s),{},{gridArea:"username",children:[Object(ce.jsx)(Ae.c,{pointerEvents:"none",children:Object(ce.jsx)(Dt,{})}),Object(ce.jsx)(Ae.a,Object(h.a)(Object(h.a)(Object(h.a)({},r),s),{},{maxlength:24,placeholder:"username"})),Object(ce.jsx)(zt,{username:r.value})]})),Object(ce.jsxs)(Ae.b,Object(h.a)(Object(h.a)({},s),{},{gridArea:"password",children:[Object(ce.jsx)(Ae.c,{pointerEvents:"none",children:Object(ce.jsx)(Lt,{})}),Object(ce.jsx)(Ae.a,Object(h.a)(Object(h.a)(Object(h.a)({},a),s),{},{maxlength:18,placeholder:"password"}))]})),Object(ce.jsx)(Ae.b,Object(h.a)(Object(h.a)({},s),{},{gridArea:"verify",children:Object(ce.jsx)(Ae.a,Object(h.a)(Object(h.a)(Object(h.a)({},c),s),{},{placeholder:"verify"}))})),Object(ce.jsx)(Ft,{username:r.value,password:a.value,gridArea:"tooltips"}),l]}))})},Rt=function(){var e=Object(u.c)((function(e){return e.userFormViews.signupForm})),t=Object(u.c)((function(e){return e.userFormViews.signupSpinner})),n=Object(u.b)(),r=Object(l.a)(),a=Ie("text"),c=Ie("text"),o=Ie("text"),i=Ie("password"),s=Ie("password");return e?Object(ce.jsx)(Tt,{username:a,firstName:c,lastName:o,password:i,verify:s,handleSignup:function(e){e.preventDefault(),new Promise((function(e){n((function(e){e({type:"".concat(He,"/spinner/show")})}));var t,r=n((t={username:a.value,firstName:c.value,lastName:o.value,password:i.value,verify:s.value},function(){var e=Object(v.a)(x.a.mark((function e(n){var r,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=mt(t),e.next=3,It.signup(r);case 3:return a=e.sent,n({type:"login/storeToken",payload:a}),n({type:"login/init",payload:a}),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));e(r)})).then((function(e){S(e)&&(r(Ke.success(e.name)),a.clearField(),c.clearField(),o.clearField(),i.clearField(),s.clearField(),n((function(e){e({type:"".concat(He,"/hide")})})))})).catch((function(e){console.error("Failed to create user: ".concat(e.message)),r(Vt.failed("Failed to create user"))})).finally((function(){n((function(e){e({type:"".concat(He,"/spinner/hide")})}))}))},spinnerVisible:t}):null};var Jt=function(){var e=Object(u.b)(),t=Object(l.a)();return Object(r.useEffect)((function(){try{e(ne()),e((function(e){var t=I();t&&e({type:"login/init",payload:t})}))}catch(n){console.error("Network error during notes initialization"),t(O.failedGet)}}),[e]),Object(ce.jsx)(b.a,{children:Object(ce.jsx)(i.a,{children:Object(ce.jsxs)(d.a,{children:[Object(ce.jsx)(oe,{}),Object(ce.jsx)(it,{}),Object(ce.jsxs)(s.c,{children:[Object(ce.jsxs)(s.a,{path:"/notes",children:[Object(ce.jsx)(Ne,{}),Object(ce.jsx)(Ve,{})]}),Object(ce.jsx)(s.a,{path:"/pad",children:Object(ce.jsx)(Ge,{})}),Object(ce.jsx)(s.a,{path:"/",children:Object(ce.jsx)(ie,{})})]})," ",Object(ce.jsx)("br",{}),Object(ce.jsx)(tt,{}),Object(ce.jsx)(Rt,{})]})})})},Ut=n(56),Bt=n(95),Gt=Object(Ut.b)({notes:re,login:A,signup:_t,userFormViews:Ye,noteActionViews:ge}),Mt=Object(Ut.c)(Gt,Object(Ut.a)(Bt.a));n(198);o.a.render(Object(ce.jsx)(u.a,{store:Mt,children:Object(ce.jsx)(Jt,{})}),document.getElementById("root"))}},[[199,1,2]]]);
//# sourceMappingURL=main.e066ad4d.chunk.js.map